{% schema %}
{
  "name": "Plant Landing Slider",
  "settings": [
    { "type": "text", "id": "heading", "label": "Heading", "default": "Shop Beautiful Plants for Every Home" },
    { "type": "textarea", "id": "subtext", "label": "Subtext", "default": "Premium plants, easy care, and fast delivery â€” everything you need to grow with confidence." },
    { "type": "text", "id": "button_text", "label": "Button text", "default": "View all items" },
    { "type": "url", "id": "button_link", "label": "Button link" }
  ],
  "blocks": [
    {
      "type": "slide",
      "name": "Slide",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Slide image" }
      ]
    }
  ],
  "presets": [{ "name": "Plant Landing Slider" }]
}
{% endschema %}

<style>
/* ================= DESKTOP ================= */
.plant-hero {
  display: flex;
  align-items: center;
  justify-content: space-between;
  min-height: 80vh;
  padding: 60px;
  background: #fff;
  gap: 40px;
}

.plant-hero__content {
  flex: 1;
  max-width: 520px;
}

.plant-hero__content h1 {
  font-size: 56px;
  line-height: 1.1;
  color: #1f3d1b;
  margin-bottom: 18px;
}

.plant-hero__content p {
  font-size: 18px;
  color: #555;
  line-height: 1.6;
}

.plant-hero__btn {
  display: inline-block;
  margin-top: 26px;
  background: #1f3d1b;
  color: #fff;
  padding: 14px 36px;
  border-radius: 10px;
  font-weight: 600;
}

.plant-hero__slider {
  flex: 1;
  position: relative;
  text-align: center;
}

.plant-slide { display: none; }
.plant-slide.active { display: block; }

.plant-slide img {
  max-width: 380px;
  height: auto;
  margin: 0 auto;
}

.plant-dots {
  position: absolute;
  right: -30px;
  top: 50%;
  transform: translateY(-50%);
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.plant-dot {
  width: 10px;
  height: 10px;
  background: #cfd8cf;
  border-radius: 50%;
  cursor: pointer;
}

.plant-dot.active {
  background: #1f3d1b;
}

/* ================= TABLET ================= */
@media (max-width: 1024px) {
  .plant-hero {
    padding: 40px 30px;
    gap: 30px;
  }

  .plant-hero__content h1 {
    font-size: 42px;
  }

  .plant-slide img {
    max-width: 300px;
  }
}

/* ================= MOBILE IMAGE FIX ================= */
@media (max-width: 768px) {
  /* Make sure absolute elements stay inside hero */
  .plant-hero {
    position: relative !important;
    overflow: visible !important;
  }

  /* Keep the content card as a real container */
  .plant-hero__content {
    position: relative !important;
    padding-bottom: 220px !important; /* space for plant image */
  }

  /* Place slider inside the card */
  .plant-hero__slider {
    position: absolute !important;
    right: 22px !important;
    bottom: 28px !important;
    width: 180px !important;
    height: 200px !important;
    display: flex !important;
    align-items: flex-end !important;
    justify-content: center !important;
    z-index: 3 !important;
  }

  /* Show only active slide */
  .plant-slide {
    display: none !important;
  }
  .plant-slide.active {
    display: block !important;
  }

  /* Correct image scaling */
  .plant-slide img {
    width: 180px !important;
    max-width: 180px !important;
    height: auto !important;
    display: block !important;
    margin: 0 !important;
  }

  /* Dots under the image (like mockup) */
  .plant-dots {
    position: absolute !important;
    right: 40px !important;
    bottom: 10px !important;
    display: flex !important;
    flex-direction: row !important;
    gap: 6px !important;
    transform: none !important;
    z-index: 4 !important;
  }
}

</style>

<section class="plant-hero" id="plantHero">
  <div class="plant-hero__content">
    <h1>{{ section.settings.heading }}</h1>
    <p>{{ section.settings.subtext }}</p>
    <a href="{{ section.settings.button_link }}" class="plant-hero__btn">
      {{ section.settings.button_text }}
    </a>
  </div>

  <div class="plant-hero__slider">
    {% assign slide_blocks = section.blocks | where: "type", "slide" %}

    {% for block in slide_blocks %}
      <div class="plant-slide {% if forloop.first %}active{% endif %}">
        {% if block.settings.image %}
          <img
            src="{{ block.settings.image | image_url: width: 600 }}"
            alt="{{ block.settings.image.alt | escape }}"
            width="{{ block.settings.image.width }}"
            height="{{ block.settings.image.height }}"
            loading="lazy"
          >
        {% endif %}
      </div>
    {% endfor %}

    {% if slide_blocks.size > 1 %}
      <div class="plant-dots">
        {% for block in slide_blocks %}
          <span class="plant-dot {% if forloop.first %}active{% endif %}" data-index="{{ forloop.index0 }}"></span>
        {% endfor %}
      </div>
    {% endif %}
  </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function () {
  const slider = document.getElementById('plantHero');
  if (!slider) return;

  const slides = slider.querySelectorAll('.plant-slide');
  const dots = slider.querySelectorAll('.plant-dot');
  let current = 0;

  function showSlide(i) {
    slides.forEach((s, idx) => s.classList.toggle('active', idx === i));
    dots.forEach((d, idx) => d.classList.toggle('active', idx === i));
    current = i;
  }

  dots.forEach(dot => {
    dot.addEventListener('click', () => {
      showSlide(parseInt(dot.dataset.index, 10));
    });
  });

  if (slides.length > 1) {
    setInterval(() => {
      showSlide((current + 1) % slides.length);
    }, 4000);
  }
});
</script>
