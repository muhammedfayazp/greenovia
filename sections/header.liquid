{% comment %}
  Header Section with Sticky Navigation
{% endcomment %}

<header class="header" data-section-id="{{ section.id }}" data-section-type="header">
  {%- if section.settings.show_top_bar -%}
    <div class="header__top">
      <div class="container">
        <div class="header__top-inner">
          <div class="header__top-left">
            {%- if section.settings.top_bar_text != blank -%}
              {{ section.settings.top_bar_text }}
            {%- endif -%}
          </div>
          <div class="header__top-right">
            {%- if section.settings.show_language_selector and shop.published_locales.size > 1 -%}
              {% render 'language-selector' %}
            {%- endif -%}
            {%- if section.settings.show_currency_selector and shop.enabled_currencies.size > 1 -%}
              {% render 'currency-selector' %}
            {%- endif -%}
          </div>
        </div>
      </div>
    </div>
  {%- endif -%}

  <div class="header__main">
    <div class="container">
      <div class="header__inner">
        {%- comment -%} Mobile Menu Toggle {%- endcomment -%}
        <button class="mobile-menu-toggle header__icon" aria-label="Menu" type="button">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="3" y1="12" x2="21" y2="12"></line>
            <line x1="3" y1="6" x2="21" y2="6"></line>
            <line x1="3" y1="18" x2="21" y2="18"></line>
          </svg>
        </button>

        {%- comment -%} Logo {%- endcomment -%}
        <div class="header__logo">
          <a href="{{ routes.root_url }}" class="header__logo-link">
            {%- if section.settings.logo != blank -%}
              <img 
                src="{{ section.settings.logo | img_url: '200x' }}" 
                alt="{{ shop.name }}"
                class="header__logo-image"
                width="{{ section.settings.logo_width }}"
                height="auto"
              >
            {%- else -%}
              <span class="header__logo-text">{{ shop.name }}</span>
            {%- endif -%}
          </a>
        </div>

        {%- comment -%} Search Bar {%- endcomment -%}
        {%- if section.settings.show_search -%}
          <div class="header__search">
            <form action="{{ routes.search_url }}" method="get" class="search-form" role="search">
              <input 
                type="search" 
                name="q" 
                placeholder="{{ 'general.search.placeholder' | t }}"
                class="search-form__input"
                aria-label="{{ 'general.search.placeholder' | t }}"
              >
              <button type="submit" class="search-form__button" aria-label="{{ 'general.search.submit' | t }}">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="11" cy="11" r="8"></circle>
                  <path d="m21 21-4.35-4.35"></path>
                </svg>
              </button>
            </form>
          </div>
        {%- endif -%}

        {%- comment -%} Header Icons {%- endcomment -%}
        <div class="header__icons">
          {%- comment -%} Wishlist {%- endcomment -%}
          {%- if section.settings.show_wishlist -%}
            <a href="/pages/wishlist" class="header__icon header__icon--wishlist" aria-label="Wishlist">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
              </svg>
              <span class="header__icon-count wishlist-count">0</span>
            </a>
          {%- endif -%}

          {%- comment -%} Account {%- endcomment -%}
          <a href="{{ routes.account_url }}" class="header__icon header__icon--account" aria-label="Account">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
              <circle cx="12" cy="7" r="4"></circle>
            </svg>
          </a>

          {%- comment -%} Cart {%- endcomment -%}
          <button class="header__icon header__icon--cart" aria-label="Cart" type="button">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="9" cy="21" r="1"></circle>
              <circle cx="20" cy="21" r="1"></circle>
              <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
            </svg>
            <span class="header__icon-count">{{ cart.item_count }}</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  {%- comment -%} Main Navigation {%- endcomment -%}
  {%- if section.settings.show_main_nav -%}
    <nav class="navigation" role="navigation">
      <div class="container">
        <div class="navigation__inner">
          <ul class="navigation__list">
            {%- for link in linklists[section.settings.menu].links -%}
              <li class="navigation__item">
                <a href="{{ link.url }}" class="navigation__link">
                  {{ link.title }}
                </a>
                {%- if link.links != blank -%}
                  <ul class="navigation__submenu">
                    {%- for childlink in link.links -%}
                      <li class="navigation__submenu-item">
                        <a href="{{ childlink.url }}" class="navigation__submenu-link">
                          {{ childlink.title }}
                        </a>
                      </li>
                    {%- endfor -%}
                  </ul>
                {%- endif -%}
              </li>
            {%- endfor -%}
          </ul>
        </div>
      </div>
    </nav>
  {%- endif -%}
</header>

{%- comment -%} Mobile Menu {%- endcomment -%}
<div class="mobile-menu">
  <div class="mobile-menu__header">
    <span class="mobile-menu__title">Menu</span>
    <button class="mobile-menu__close" aria-label="Close menu" type="button">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    </button>
  </div>
  <div class="mobile-menu__body">
    <ul class="mobile-menu__list">
      {%- for link in linklists[section.settings.menu].links -%}
        <li class="mobile-menu__item">
          <a href="{{ link.url }}" class="mobile-menu__link">{{ link.title }}</a>
        </li>
      {%- endfor -%}
    </ul>
  </div>
</div>

<style>
  .mobile-menu {
    position: fixed;
    top: 0;
    left: -100%;
    width: 80%;
    max-width: 400px;
    height: 100vh;
    background-color: var(--color-white);
    box-shadow: var(--shadow-xl);
    transition: left var(--transition-base);
    z-index: 1001;
  }

  .mobile-menu.active {
    left: 0;
  }

  .mobile-menu__header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--space-md);
    border-bottom: 1px solid var(--color-border);
  }

  .mobile-menu__title {
    font-size: 2rem;
    font-weight: 600;
  }

  .mobile-menu__close {
    background: none;
    border: none;
    padding: var(--space-xs);
    cursor: pointer;
    color: var(--color-text-secondary);
  }

  .mobile-menu__body {
    padding: var(--space-md);
  }

  .mobile-menu__list {
    list-style: none;
  }

  .mobile-menu__item {
    border-bottom: 1px solid var(--color-border);
  }

  .mobile-menu__link {
    display: block;
    padding: var(--space-md) 0;
    font-size: 1.6rem;
    font-weight: 500;
  }

  @media (min-width: 769px) {
    .mobile-menu-toggle {
      display: none;
    }
  }

  @media (max-width: 768px) {
    .navigation {
      display: none;
    }
  }
</style>

{% schema %}
{
  "name": "Header",
  "settings": [
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo"
    },
    {
      "type": "range",
      "id": "logo_width",
      "min": 50,
      "max": 250,
      "step": 10,
      "default": 150,
      "unit": "px",
      "label": "Logo width"
    },
    {
      "type": "checkbox",
      "id": "show_top_bar",
      "label": "Show top bar",
      "default": true
    },
    {
      "type": "text",
      "id": "top_bar_text",
      "label": "Top bar text",
      "default": "Free Delivery on Orders Over AED 150"
    },
    {
      "type": "checkbox",
      "id": "show_language_selector",
      "label": "Show language selector",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_currency_selector",
      "label": "Show currency selector",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_search",
      "label": "Show search bar",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_wishlist",
      "label": "Show wishlist icon",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_main_nav",
      "label": "Show main navigation",
      "default": true
    },
    {
      "type": "link_list",
      "id": "menu",
      "label": "Menu",
      "default": "main-menu"
    }
  ]
}
{% endschema %}
